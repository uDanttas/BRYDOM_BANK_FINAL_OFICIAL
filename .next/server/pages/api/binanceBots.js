"use strict";(()=>{var e={};e.id=805,e.ids=[805],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},6672:(e,t,r)=>{r.r(t),r.d(t,{config:()=>p,default:()=>c,routeModule:()=>f});var a={};r.r(a),r.d(a,{default:()=>d});var o=r(1802),i=r(7153),n=r(6249);let s=require("binance-api-node");var u=r(1713);let l=s({apiKey:process.env.BINANCE_API_KEY,apiSecret:process.env.BINANCE_API_SECRET});async function d(e,t){try{for(let e of(await u.Z.bot.findMany({where:{ativo:!0},include:{usuario:!0}}))){let t=e.saldo,r=e.lucroHoje||0;if(t<5)continue;let a=r>=500;try{let o=await l.order({symbol:"USDTBRL",side:"BUY",type:"MARKET",quoteOrderQty:"5.00"});parseFloat(o.cummulativeQuoteQty||"0"),parseFloat(o.fills[0]?.price||"5");let i=parseFloat((2*Math.random()).toFixed(2));if(a){let e=await u.Z.usuario.findFirst({where:{mestre:!0}});e&&await u.Z.usuario.update({where:{cpf:e.cpf},data:{saldo:e.saldo+i}})}else await u.Z.bot.update({where:{id:e.id},data:{lucroHoje:r+i}});await u.Z.bot.update({where:{id:e.id},data:{saldo:t-5}})}catch(t){console.error(`Erro ao operar bot ${e.id}:`,t.message)}}return t.status(200).json({mensagem:"Opera\xe7\xf5es conclu\xeddas com sucesso."})}catch(e){return console.error("Erro geral:",e),t.status(500).json({erro:"Erro interno na execu\xe7\xe3o dos bots."})}}let c=(0,n.l)(a,"default"),p=(0,n.l)(a,"config"),f=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/binanceBots",pathname:"/api/binanceBots",bundlePath:"",filename:""},userland:a})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)},1713:(e,t,r)=>{r.d(t,{Z:()=>o});let a=require("@prisma/client"),o=globalThis.prisma||new a.PrismaClient}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=6672);module.exports=r})();